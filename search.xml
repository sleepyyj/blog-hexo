<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[webpack之babel-loader配置]]></title>
      <url>/2017/09/07/webpack%E4%B9%8Bbabel-loader%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前端知识体系真滴庞大，光打包工具就有好多，gulp、grunt、webpack、Yeoman、bower等等。前段时间看到一个stage属性，查了下资料，这里顺便写一写babel-loader相关的知识。</p>
<h3 id="babel-loader配置"><a href="#babel-loader配置" class="headerlink" title="babel-loader配置"></a>babel-loader配置</h3><p>babel是一个转换器，可以把JSX和ES6代码转换成普通js文件和es5代码，因为现在主流的JavaScript对es6的支持并不高，而且没有浏览器支持jsx，所以如果你想使用es6的一颗赛艇的新特性，babel是必要的。贴段代码吧</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">module: &#123;</div><div class="line">  loaders: [</div><div class="line">    &#123;</div><div class="line">        test: /\.jsx?$/, // A regexp to test the require path. accepts either js or jsx</div><div class="line">        exclude: /(node_modules|bower_components)/,</div><div class="line">        loader: 'babel', </div><div class="line">        query: &#123;</div><div class="line">            "presets": [</div><div class="line">        "react",</div><div class="line">        "es2015",</div><div class="line">        "stage-1"</div><div class="line">        ],</div><div class="line">            "plugins": ["transform-decorators-legacy"]</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>test：是一个用来匹配jsx的正则表达式<br>exclude：不列入查找范围的文件夹<br>loader：The module to load. “babel” is short for “babel-loader”<br>query：需要转换的范围，也可以写在loader选项babel的后面，如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">module: &#123;</div><div class="line">  loaders: [</div><div class="line">    &#123;</div><div class="line">		test: /\.jsx?$/, // A regexp to test the require path. accepts either js or jsx</div><div class="line">		exclude: /(node_modules|bower_components)/,</div><div class="line">		loader: 'babel?presets[]=es2015&amp;presets[]=react&amp;presets[]=stage-1', </div><div class="line">		query: &#123;</div><div class="line">      		"plugins": ["transform-decorators-legacy"] //这个插件下面会讲到</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>敲黑板。下面重点讲一下stage</p>
<h3 id="stage-0"><a href="#stage-0" class="headerlink" title="stage-0"></a>stage-0</h3><p>stage-0包含stage-1, stage-2以及stage-3的所有功能，同时还另外支持如下两个功能插件：</p>
<ul>
<li>transform-do-expressions 这个插件就是为了方便在 jsx写if/else表达式而提出的，我们可以在return中写if/else，虽然很牛逼，但是好像没啥意义，写render里就行了嘛…</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> App = React.createClass(&#123;</div><div class="line">    render()&#123;</div><div class="line">        <span class="keyword">let</span> &#123; color &#125; = <span class="keyword">this</span>.props;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;div className=<span class="string">"parents"</span>&gt;</div><div class="line">                &#123;<span class="keyword">do</span> &#123;</div><div class="line">                    <span class="keyword">if</span>(color == <span class="string">'blue'</span>) &#123; </div><div class="line">                        &lt;BlueComponent/&gt; </div><div class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(color == <span class="string">'red'</span>) &#123; </div><div class="line">                        &lt;RedComponent/&gt; </div><div class="line">                    &#125;<span class="keyword">else</span> &#123; </div><div class="line">                        &lt;GreenComponent/&gt; &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;&#125;</div><div class="line">            &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">        )</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;)</span></div></pre></td></tr></table></figure>
<ul>
<li>transform-function-bind 这个插件其实就是提供过 :: 这个操作符来方便快速切换上下文，看代码吧，这个我也没看懂</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">obj::func</div><div class="line"><span class="comment">// is equivalent to:</span></div><div class="line">func.bind(obj)</div><div class="line"></div><div class="line">obj::func(val)</div><div class="line"><span class="comment">// is equivalent to:</span></div><div class="line">func.call(obj, val)</div><div class="line"></div><div class="line">::obj.func(val)</div><div class="line"><span class="comment">// is equivalent to:</span></div><div class="line">func.call(obj, val)</div><div class="line"></div><div class="line"><span class="comment">// 再来一个复杂点的样例</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> box = &#123;</div><div class="line">  weight: <span class="number">2</span>,</div><div class="line">  getWeight() &#123; <span class="keyword">return</span> <span class="keyword">this</span>.weight; &#125;,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> &#123; getWeight &#125; = box;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(box.getWeight()); <span class="comment">// prints '2'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> bigBox = &#123; <span class="attr">weight</span>: <span class="number">10</span> &#125;;</div><div class="line"><span class="built_in">console</span>.log(bigBox::getWeight()); <span class="comment">// prints '10'</span></div><div class="line"></div><div class="line"><span class="comment">// Can be chained:</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">val</span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span> + val; &#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(bigBox::getWeight()::add(<span class="number">5</span>)); <span class="comment">// prints '15'</span></div></pre></td></tr></table></figure>
<h3 id="stage-1"><a href="#stage-1" class="headerlink" title="stage-1"></a>stage-1</h3><p>stage-1除了包含stage-2和stage-3，还包含了下面2个插件：﻿</p>
<ul>
<li>transform-class-properties 官方文档中这个插件已经被废弃</li>
<li>transform-export-extensions 对不起，我也不知道这个是干嘛的，官方文档也没有解释…</li>
</ul>
<h3 id="stage-2"><a href="#stage-2" class="headerlink" title="stage-2"></a>stage-2</h3><p>它除了覆盖stage-3的所有功能，还支持如下两个插件：</p>
<ul>
<li>syntax-trailing-function-commas 尾逗号函数，这个就不贴代码了，就是在数组或对象的最后一个元素的后面加逗号不会报错，很实用</li>
<li>transform-object-reset-spread 其实它是对 ES6中解构赋值的一个扩展，因为ES6只支持对数组的解构赋值，对对象是不支持的。如下面的代码所示：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 获取剩下的属性</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> &#123; x, y, ...z &#125; = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">a</span>: <span class="number">3</span>, <span class="attr">b</span>: <span class="number">4</span> &#125;;</div><div class="line"><span class="built_in">console</span>.log(x); <span class="comment">// 1</span></div><div class="line"><span class="built_in">console</span>.log(y); <span class="comment">// 2</span></div><div class="line"><span class="built_in">console</span>.log(z); <span class="comment">// &#123; a: 3, b: 4 &#125;</span></div><div class="line"></div><div class="line"><span class="comment">// 属性展开</span></div><div class="line"><span class="keyword">let</span> n = &#123; x, y, ...z &#125;;</div><div class="line"><span class="built_in">console</span>.log(n); <span class="comment">// &#123; x: 1, y: 2, a: 3, b: 4 &#125;</span></div></pre></td></tr></table></figure>
<h3 id="stage-3"><a href="#stage-3" class="headerlink" title="stage-3"></a>stage-3</h3><p>它支持大名鼎鼎的async和await, 这两个哥们可是解决(Ajax)回调函数的终极解决方法呀！管你什么异步，我都可以用同步的思维来写，ES7里面非常强悍的存在。总的来说，它包含如下两个插件:</p>
<ul>
<li>transform-async-to-generator 主要用来支持ES7中的async和await</li>
<li>transform-exponentiation-operator<br>transform-exponentiation-operator这个插件算是一个语法糖，可以通过**这个符号来进行幂操作，想当于Math.pow(a,b)。如下面的样例</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// x ** y</span></div><div class="line"><span class="keyword">let</span> squared = <span class="number">2</span> ** <span class="number">2</span>;</div><div class="line"><span class="comment">// 相当于: 2 * 2</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> cubed = <span class="number">2</span> ** <span class="number">3</span>;</div><div class="line"><span class="comment">// 相当于: 2 * 2 * 2</span></div><div class="line"></div><div class="line"><span class="comment">// x **= y</span></div><div class="line"><span class="keyword">let</span> a = <span class="number">2</span>;</div><div class="line">a **= <span class="number">2</span>;</div><div class="line"><span class="comment">// 相当于: a = a * a;</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="number">3</span>;</div><div class="line">b **= <span class="number">3</span>;</div><div class="line"><span class="comment">// 相当于: b = b * b * b;</span></div></pre></td></tr></table></figure>
<p>如果分不清stage-0、stage-1、stage-2、stage-3区别，请写上stage-0，就能嗨起来了…放心的使用es6和es7的新特性。</p>
]]></content>
      
        <categories>
            
            <category> webpack </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JS实现全屏的一些坑]]></title>
      <url>/2017/08/29/JS%E5%AE%9E%E7%8E%B0%E5%85%A8%E5%B1%8F%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9D%91/</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前两天做了一个pdf全屏播放的功能，以为看看API就能完成的，没想到因为一个keydown的问题浪费了大半天。</p>
<h3 id="先看下API"><a href="#先看下API" class="headerlink" title="先看下API"></a>先看下API</h3><p><code>Document.fullscreen</code>：检测当前页面是否全屏<br><code>Document.fullscreenEnabled</code>：当前页面是否允许全屏<br><code>Document.fullscreenElement</code>：输出当前的全屏的元素<br><code>Document.onfullscreenchange</code>：在exitFullscreen和requestFullscreen的时候会触发<br><code>Document.onfullscreenerror</code>：全屏事件出现错误时进行一些操作<br><code>Document.exitFullscreen()</code>：手动退出全屏<br><code>Element.requestFullscreen()</code>：手动进入全屏</p>
<p>使用的时候需要加上浏览器前缀</p>
<h3 id="requestFullscreen"><a href="#requestFullscreen" class="headerlink" title="requestFullscreen()"></a>requestFullscreen()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(element.requestFullscreen) &#123;</div><div class="line">    element.requestFullscreen();</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(element.mozRequestFullScreen) &#123;</div><div class="line">    element.mozRequestFullScreen();</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(element.msRequestFullscreen)&#123;</div><div class="line">    element.msRequestFullscreen();</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(element.webkitRequestFullscreen) &#123;</div><div class="line">    element.webkitRequestFullScreen();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注意；全屏窗口不可滚动查看内容，全屏元素需加width: 100%;height: 100%;overflow: auto; 控制 ，以达到各浏览器显示效果一致（注：Gecko 会为元素自动添加 CSS 使其伸展以便铺满屏幕： “width: 100%; height: 100%”。 WebKit 则不会这么做；它会让全屏的元素以原始尺寸居中到屏幕中央，其余部分变为黑色。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-pseudo">:-webkit-full-screen</span>&#123;</div><div class="line">    <span class="attribute">width</span>:<span class="number">100%</span>;</div><div class="line">    <span class="attribute">height</span>:<span class="number">100%</span>;</div><div class="line">    <span class="attribute">background</span>: <span class="number">#11ee11</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>所有全屏化的祖先元素样式：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-pseudo">:fullscreen-ancestor</span>&#123;</div><div class="line">    <span class="attribute">z-index</span>: -<span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>进入全屏标准写法requestFullscreen中的screen单词首字母是小写s，ms只需加上各自的浏览器前缀即可，但firefox和chrome除了加前缀screen单词首个字母必须大写：mozRequestFullScreen() webkitRequestFullScreen()</p>
<h3 id="exitFullscreen"><a href="#exitFullscreen" class="headerlink" title="exitFullscreen()"></a>exitFullscreen()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="built_in">document</span>.exitFullscreen) &#123;</div><div class="line">    <span class="built_in">document</span>.exitFullscreen();</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.msExitFullscreen) &#123;</div><div class="line">    <span class="built_in">document</span>.msExitFullscreen();</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.mozCancelFullScreen) &#123;</div><div class="line">    <span class="built_in">document</span>.mozCancelFullScreen();</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.webkitExitFullscreen) &#123;</div><div class="line">    <span class="built_in">document</span>.webkitExitFullscreen();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>用户手动按下ESC键或F11键，也可以退出全屏键。此外，加载新的页面，或者切换tab，或者从浏览器转向其他应用（按下Alt-Tab），也会导致退出全屏状态。<br>最坑的就是在Chrome下，按esc不会退出全屏，而且给esc加keydown事件手动去触发exitFullscreen也不行。最后把事件绑在了x和F11上，另一种解决方法就是在全屏界面上悬浮一个退出全屏的按钮，去调用exitFullscreen，这样好像比较舒服一点。</p>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ow</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(p)&#123;</div><div class="line">        <span class="keyword">super</span>(p)</div><div class="line">        <span class="keyword">this</span>._name = <span class="keyword">this</span>.props.__name.replace(<span class="string">".aliyuncs.com"</span>,<span class="string">"-internal.aliyuncs.com"</span>)</div><div class="line">    &#125;</div><div class="line">    exitFullScreen=<span class="function"><span class="params">()</span>=&gt;</span> &#123;</div><div class="line">        <span class="built_in">document</span>.webkitCancelFullScreen()</div><div class="line">    &#125;</div><div class="line">    load=<span class="function"><span class="params">()</span>=&gt;</span> &#123;</div><div class="line">        <span class="keyword">var</span> doc = <span class="keyword">this</span>._d.contentWindow.document</div><div class="line">        doc.addEventListener(<span class="string">"keydown"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">            <span class="keyword">if</span> (e.key == <span class="string">"F11"</span> || e.key == <span class="string">"x"</span>) &#123;</div><div class="line">                <span class="built_in">document</span>.webkitCancelFullScreen()</div><div class="line">                Plaso.hideTop()</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    componentDidMount()&#123;</div><div class="line">        <span class="keyword">var</span> d = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'iframe'</span>)[<span class="number">0</span>]</div><div class="line">        <span class="keyword">this</span>._d=d</div><div class="line">        d.webkitRequestFullScreen()</div><div class="line">    &#125;</div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">var</span> props=<span class="keyword">this</span>.props</div><div class="line">        <span class="keyword">var</span> path=<span class="string">""</span></div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;div className=&#123;lcns([<span class="string">"border"</span>])&#125;&gt;</div><div class="line">                &lt;div className=&#123;lcns([<span class="string">"exit"</span>])&#125; onClick=&#123;<span class="keyword">this</span>.exitFullScreen&#125;&gt;退出全屏&lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">                &lt;iframe className=&#123;lcns(["iframe"])&#125; src=&#123;path&#125; allowFullScreen="true" onLoad=&#123;this.load&#125;/</span>&gt;</div><div class="line">            &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">        );</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp">module.exports=ow</span></div></pre></td></tr></table></figure>
<p><strong>有几个注意点</strong><br>1、我这边要全屏的元素是iframe，所以记得加上<code>allowFullScreen=&quot;true&quot;</code><br>2、keydown事件在iframe加载完之后再绑定，写在componentDidMount里面是没有用的，要写在iframe的onload里面<br>3、keydown事件要绑在iframe的document上（contentWindow.document），而不是外层的document</p>
<h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fullscreen_API" title="Fullscreen_API" target="_blank" rel="external">Fullscreen_API</a></p>
]]></content>
      
        <categories>
            
            <category> JavaScript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Git：世界上最好的版本控制工具]]></title>
      <url>/2017/08/26/Git%EF%BC%9A%E4%B8%96%E7%95%8C%E4%B8%8A%E6%9C%80%E5%A5%BD%E7%9A%84%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7/</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>去年用的是SVN，换了家公司用了git，没有对比就没有伤害，不得不承认git是世界上最好的版本控制工具。本文记下常用的git命令，内容大多参考廖雪峰老师的git教程。加上自己工作中用到的一些命令。这里就不介绍工作区、暂存区、版本库和远程库的概念了。</p>
<h3 id="初始化："><a href="#初始化：" class="headerlink" title="初始化："></a>初始化：</h3><ul>
<li>初始化一个Git仓库，使用git init命令。 添加文件到Git仓库，分两步： <ul>
<li>第一步，使用命令<code>git add &lt;file&gt;</code>，注意，可反复多次使用，添加多个文件； </li>
<li>第二步，使用命令<code>git commit</code>，完成。</li>
</ul>
</li>
<li>要随时掌握工作区的状态，使用<code>git status</code>命令。 </li>
<li>如果<code>git status</code>告诉你有文件被修改过，用<code>git diff</code>可以查看修改内容。</li>
</ul>
<h3 id="版本回退"><a href="#版本回退" class="headerlink" title="版本回退"></a>版本回退</h3><ul>
<li>HEAD指向的版本就是当前版本，因此，Git允许我们在版本的历史之间穿梭，使用命令<code>git reset --hard commit_id</code>。</li>
<li>穿梭前，用<code>git log</code>可以查看提交历史，以便确定要回退到哪个版本。<br>要重返未来，用<code>git reflog</code>查看命令历史，以便确定要回到未来的哪个版本。</li>
<li>每次修改，如果不add到暂存区，那就不会加入到commit中。<ul>
<li>场景1：当你改乱了工作区某个文件的内容，想直接丢弃工作区的修改时，用命令<code>git checkout -- file</code>。</li>
<li>场景2：当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令<code>git reset HEAD file</code>，就回到了场景1，第二步按场景1操作。</li>
<li>场景3：已经提交了不合适的修改到版本库时，想要撤销本次提交，参考版本回退一节，不过前提是没有推送到远程库。</li>
</ul>
</li>
<li>命令<code>git rm</code>用于删除一个文件。如果一个文件已经被提交到版本库，那么你永远不用担心误删，但是要小心，你只能恢复文件到最新版本，你会丢失最近一次提交后你修改的内容。</li>
</ul>
<h3 id="远程仓库"><a href="#远程仓库" class="headerlink" title="远程仓库"></a>远程仓库</h3><ul>
<li>要关联一个远程库，使用命<code>令git remote add origin git@server-name:path/repo-name.git</code>；</li>
<li>关联后，使用命令<code>git push -u origin master第一次推送master分支的所有内容</code>；</li>
<li>此后，每次本地提交后，只要有必要，就可以使用命令<code>git push origin master</code>推送最新修改；</li>
<li>要克隆一个仓库，首先必须知道仓库的地址，然后使用<code>git clone</code>命令克隆。<br>Git支持多种协议，包括https，但通过ssh支持的原生git协议速度最快。</li>
</ul>
<h3 id="创建与合并分支"><a href="#创建与合并分支" class="headerlink" title="创建与合并分支"></a>创建与合并分支</h3><p>Git鼓励大量使用分支：<br>查看分支：<code>git branch</code><br>创建分支：<code>git branch &lt;name&gt;</code><br>切换分支：<code>git checkout &lt;name&gt;</code><br>创建+切换分支：<code>git checkout -b &lt;name&gt;</code><br>合并某分支到当前分支：<code>git merge &lt;name&gt;</code><br>删除分支：<code>git branch -d &lt;name&gt;</code><br>当Git无法自动合并分支时，就必须首先解决冲突。解决冲突后，再提交，合并完成。<br>用<code>git log --grap</code>h命令可以看到分支合并图。<br>合并分支时，加上<code>--no-ff</code>参数就可以用普通模式合并，合并后的历史有分支，能看出来曾经做过合并，而fast forward合并就看不出来曾经做过合并。</p>
<h3 id="bug分支"><a href="#bug分支" class="headerlink" title="bug分支"></a>bug分支</h3><ul>
<li>当手头工作没有完成时，先把工作现场<code>git stash</code>一下，然后去修复bug，修复后，再<code>git stash pop</code>，回到工作现场。</li>
<li>用<code>git stash list</code>命令看看，工作现场还在，Git把stash内容存在某个地方了，但是需要恢复一下，有两个办法：<br>一是用<code>git stash apply</code>恢复，但是恢复后，stash内容并不删除，你需要用<code>git stash drop</code>来删除；<br>另一种方式是用<code>git stash pop</code>，恢复的同时把stash内容也删了：</li>
</ul>
<h3 id="feature分支"><a href="#feature分支" class="headerlink" title="feature分支"></a>feature分支</h3><p>开发一个新feature，最好新建一个分支；<br>如果要丢弃一个没有被合并过的分支，可以通过<code>git branch -D &lt;name&gt;</code>强行删除。</p>
<h3 id="多人合作"><a href="#多人合作" class="headerlink" title="多人合作"></a>多人合作</h3><p>多人协作的工作模式通常是这样：<br>首先，可以试图用<code>git push origin branch-name</code>推送自己的修改，如果推送失败，则因为远程分支比你的本地更新，需要先用<code>git pull</code>试图合并，如果合并有冲突，则解决冲突，并在本地提交，没有冲突或者解决掉冲突后，再用<code>git push origin branch-name</code>推送就能成功！<br>如果<code>git pull</code>提示“no tracking information”，则说明本地分支和远程分支的链接关系没有创建，用命令<code>git branch --set-upstream branch-name origin/branch-name</code>。这就是多人协作的工作模式，一旦熟悉了，就非常简单。</p>
<h3 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h3><p><code>git tag &lt;name&gt;</code>：用于新建一个标签，默认为HEAD，也可以指定一个commit id；<br><code>git tag -a &lt;tagname&gt; -m &quot;blablabla...&quot;</code>：可以指定标签信息；<br><code>git tag -s &lt;tagname&gt; -m &quot;blablabla...&quot;</code>：可以用PGP签名标签；<br><code>git tag</code>：可以查看所有标签。<br><code>git push origin &lt;tagname&gt;</code>：可以推送一个本地标签；<br><code>git push origin --tags</code>：可以推送全部未推送过的本地标签；<br><code>git tag -d &lt;tagname&gt;</code>：可以删除一个本地标签；<br><code>git push origin :refs/tags/&lt;tagname&gt;</code>：可以删除一个远程标签。</p>
<h3 id="贴一份常用命令的别名"><a href="#贴一份常用命令的别名" class="headerlink" title="贴一份常用命令的别名"></a>贴一份常用命令的别名</h3><p><img src="https://raw.githubusercontent.com/sleepyyj/learngit/master/images/gitalias.png" alt="git alias" title="git alias"></p>
<h3 id="子模块"><a href="#子模块" class="headerlink" title="子模块"></a>子模块</h3><ul>
<li>项目中可能会用到一些通用的模块，可以提取出来作为一个单独的project被多个项目公用。使用<code>git submodule add</code>将一个外部项目添加为子模块。如果想从远程库拉一个带子模块的项目，clone之后会发现子模块的目录是空的。这时候先运行<code>git submodule init</code>初始化本地的配置文件，<code>git submodule update</code>拉取子模块的数据到本地。</li>
<li>需要注意的是，每次在子模块中add、commmit、push后回到上层模块，<code>git status</code>看一下会发现子模块有new commits，这时要在层模块再来一套add、commit、push，否则多人协作时，他人无法知道你修改了子模块。同理，其他人需要同步你提交的代码，在pull完之后运行<code>git submodule update</code>即可。</li>
<li>特别注意：如果没有在子模块中push，而在上层模块push的话，在上层模块<code>git status</code>显示的是 modify content而不是new commits。这种情况下，其他人<code>git submodule update</code>的时候会报错，提示找不到那个子模块的commit id，那是肯定的，因为你并没有在子模块中push。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/sleepyyj/learngit/master/images/nocommitid.png" alt="no commit id" title="no commit id"></p>
<h3 id="git-merge和git-rebase的区别"><a href="#git-merge和git-rebase的区别" class="headerlink" title="git merge和git rebase的区别"></a>git merge和git rebase的区别</h3><p>这篇文章总结的不错，懒得写了。。。我们公司一般用rebase，rebase让树看起来比较干净。<br><a href="http://blog.csdn.net/wh_19910525/article/details/7554489" target="_blank" rel="external">http://blog.csdn.net/wh_19910525/article/details/7554489</a></p>
]]></content>
      
        <categories>
            
            <category> Git </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Git </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
